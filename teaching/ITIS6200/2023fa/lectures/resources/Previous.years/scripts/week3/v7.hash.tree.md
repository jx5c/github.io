so we will continue to discuss the hash function Justin now we mentioned that if you have a file and you want to prove that you actually know the file or own the file on that specific day you could actually go to the local newspaper Cocco local newspaper and you know post the the hash result of the file so let us say now the Charlotte Observer which is the local newspaper provided its surface so whatever file you hash you give out the hash value we don't know we don't ask what the file it is we're going to publish on our newspaper and of course we're going to turn your twenty dollars for publishing the hash result so we're so when the business takes off and there are many many people come here and try to publish the hash result so now we know we have a problem so let's say this is a newspaper okay the newspaper only has that much space and if you post more hash without you have less space to put the news which is really not good for the newspaper because nobody will read a newspaper which does nothing but publishing hash it out so the Charlotte Observer come to our class that we need an approach to restrict the number of hash results that we publish every day but at the same time we want to make sure that all of our customers are happy in other words we generate a commitment for their files so what will be the be the solution this is the solution we're going to introduce here that's Merkel's hash tray this is a very very very important concept and many of the approach these days are still using this it's a very able to say creative design so let's see what is Merkel's half tray sorry so let us say that you have four files you want to generate the publish you want to publish the hash result so you instead of you have wave 1 F 2 F 3 and therefore instead of hashing every file in the published for has result on the newspaper we are going to build a tree this is what going to happen we have Phi 1 Phi 2 Phi 3 and Phi 4 okay so the first thing is the author of the files will hash the reads out hash the file since they owned the files they will be able to hash it okay and then they give this hash readout to the newspaper said okay I want you guys to publish the half result so that we can verify and the newspaper will suggest a different solution so let's say this is called h1 equals two hash of the H have five file one this is called a hash two this is called hash three this is called hash 4 instead of instead of publishing every hash without separately we're going to build a tree so what are we going to do we're going to build a hash value are called h1 2 which is the hash of h1 concatenate where's hash two so look at this value h1 is determined by the file and for your hash have found f1 you got h1 h2 is determined by f2 and then you concatenate these two value again hashing them again you get a new value we called h 1 to h 1 2 will be jointly determined by the content of file 1 and the file - if you change anything in either of the file the corresponding hash entry will be changing for example you change anything you have one h1 will change if h1 change here at one change h1 - will change as well similarly the Charlotte Observer will build something called h3 4 which is the hash of the concatenation of h3 and h4 is at the end of course not they're going to build something called H 1 - 4 equals 2 hash h1 - and h-34 so we make it simple we build a binary training we build a binary tree so every time the number of nodes in the tree will shrink by half because your kid merging them so eventually you're going to have a single root of the tree and then the Charlotte Observer will publish h14 in the newspaper in the newspaper so now we face a problem the problem is how can user one verify so let's see what user one has user one will have f1 which using hash he can generate H one and the next morning he's going to CH one for in the newspaper H one country billed to a 24 but there are other information you need to reconstruct so what can user 1 2 in other words when the newspaper give the user 1 some information so that he or she can verify what will the newspaper give you the one ok so let's see so here is what the newspaper will give the user 1 he will give you the one H 2 and H 3 4 only these two entries ok so let me use the red one to label it ok user 1 has file F 1 ok obviously file F 2 is a private file of user - we cannot give him that on the contrary we give him H 2 and H 3 4 so here let's see what will happen first the Euler one has f1 he has it he will get eight one and then he concatenate h1 and h2 h1 he generated by himself h2 come from the newspaper and he concatenate h1 and h2 hash again he will get h1 to here I used the dotted line to circle it so in this way you know this is a calculation without this is not directly given to the user by the newspaper yes and then now the newspaper also gives him eight three four so concatenate h1 - and eighty three four he will be able to recalculate h1 for okay and then he can compare the h1 for he calculates by himself to the published h1 for on the newspaper if they're the same you know that your hatch without is already begin if it's not the same you got counted by that local newspaper get your $20 back okay so what's the beauty of this so the user one will still have will have the file f1 if we give him h2 and h3 four because of this one they property of the hash function he or she will not be able to figure out what is f2 what is f3 or what is f4 in other words you cannot reverse a hash function so in this way the file for file 2003 and file for are still safe the privacy are pre the privacy is preserved at the same time we can make sure that your file 1 is actually included in this published hatch without h1 for okay so it's very interesting it's a very great idea so now the newspaper only needed to publish one instead of four result of course you can build a eight know the sixteen notes early to note whatever number of nodes you can build a hash tray so even if there are 1000 people want to publish their hash without give it to the Charlotte Observer they can build a tree and publish only one result the only difference is the Charlotte Observer need to give different people different the hash result so that they can reconstruct the tree root so please pay attention here you can see the user you one the user one will receive only one node in each level of the tree we don't need to give him h3 and h4 so that he can rebuild h3 for know we only need to give him at 3/4 directly so in other words we need to give him one node from each level as you go up and up and up until the tree because with the information we gave him he will Butte the parent node and we only needed to give the sibling of the parent node that he can calculate and then so that you can grow taller and taller into the root of the tree okay so this is Merkel's hash tray and it's actually widely used widely used so let's consider this example okay so let's say you are watching a movie so let's say your watch a movie online so of course you want to make sure that the integrity of the movie is protecting it so what can you do so you have a you have a home movie which is full gigabyte on a DVD do you first download the for whole the whole for full gigabyte verify the integrity in other words hash it compared to the hash value published by Sony Pictures and then you watch it no you're actually download something while you were watching right you're downloading and watching download and watching so you see a bar it's moving forward so what happens is like you have the whole movie we're cutting them into many many clips and every clip will actually be a file f1 f2 let's say f1 sounded so as soon as you download f1 you can start to play FY while you are downloading f2 so now the problem is after you download f1 how can you verify this is really the f1 this is not some bad guy put some fake clip and try to infect your machine of course if this movie comes from the Sony picture sony needs to guarantee the integrity of the file so what we'll do Sony will actually generate f1 f2 like f sine 1000 okay and of course here you will have h 1 to h 999 h 1000 and so on so forth you're going to grow a tree and finally at the root of the tree you're going to see and the root of the tree you are going to ch1 1000 okay this is the root of the hash value and then did it holy signed let's say Sian Sony picture hash 1 to 1000 okay so when you download f1 download f1 we're going to give you this so in this way you will be able to verify the integrity and authenticity of this h1 to 1000 but of course you only count f1 you can hash to generate h1 and then what do you need you need H to to generate h1 to h3 4 H 5 to 8 h 9 to 16 so on and so forth you will keep go up and finally you will be able to recalculate H 1 to 1000 and you'll verify the digital signature and see whether or not it is real so in this way you can keep watching the video while you're downloading each clip and you can verify the integrity of individual clips so in this way you don't have to download the whole full gigabyte of the movie to your hard drive and then you'll verify so this there is widely usage of this Merkel's hash string  
