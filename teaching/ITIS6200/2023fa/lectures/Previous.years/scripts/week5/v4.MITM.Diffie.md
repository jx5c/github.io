hi so in this video i want to continue uh talking about the dippy helmet merkel protocol and in particular uh what i thought i would do is talk about um what we call a man in the middle attack or meet in the middle of a man in the middle attack actually because it's a sexist say man in the middle you can see a person in the middle attack but we'll talk about the uh how you can actually attack the tiffy helmet protocol into the almond merkle protocol with the the man in the middle attack mitm which is sometimes referred to as uh so again we're going to start off with our with our usual parties uh and uh start off with alice on one side and bob on the other now if you recall when i first talked about the diffie-hellman vertical i refer to this kind of in-between person as eve as somebody might be eavesdropping on the channel and trying to figure out maybe what alice and bob are communicating and and this uh what i'm going to talk about now is what happens if you have an adversary who is not only eavesdropping but can actually potentially modify the messages being sent back and forth between alice and bob could that person in turn uh try to compromise the security of that protocol and it turns out that if somebody can modify the traffic in between alice and bob actually a malicious uh insider who can actually modify traffic and we'll call that insider how about mallory so mallory will see mallory can modify traffic and then again um let's give mallory some some hair um and uh you know uh maybe look for some eyes and uh in this case we'll assume that mallory can actually has is actually modifying the content so she's actually actively involved so we'll give her some some hands to show that she's actually actively involved in doing bad things uh to the communication happening between alice and bob all right so what's going to happen how is how is malaria going to affect the communication between alice and bob well let's imagine that alice starts off and we're going to have the usual setup with tiffy helman where uh there's there's a generator g for a prime group p uh and and uh you know in p uh in this case you know we're interested in arithmetic mod uh the multiplicative group mod p so zp star uh and alice as usual picks a value and she's going to uh going to pick a value lowercase a from between 0 and p minus 1 and then she computes uppercase a which is just basically g to the lowercase a mod p okay and she sends this value she's trying to send his value to bob let's say she sends it this way now let's say mallory says aha i see that alice and bob are trying to communicate together and they want to have a they want to come up with a shared secret so what if and then we're going to assume that mallory is pretty powerful mallory in this case is going to be able to actually modify the content so mallory's is going to come up with the value and she's going to pick a little value m on her own okay and m is going again it's going to be from zero to p minus one okay and then she's going to compute let's say capital m which is equal to um g to the lower case m mod p okay she's going to set instead of sending a she's going to intercept a and replace it with m okay now bob i mean he doesn't he can't tell if it's a orm it just they both look like a random number to him he doesn't know what what the difference is he's gonna see this m he's gonna think oh this is this must be coming from alice okay and so bob is going to kind of do the protocol as he normally would he's going to compute his value which is going to be um lowercase b uh which goes from zero to p minus one and by the way if you this might be a good place to just pause the video see if you can figure out what the rest of the attack is on your own given this one inside if not um you know watch the rest of the video um and then bob's going to compute from this lowercase p is going to be uppercase b equal to g to the lowercase b mod p okay and he's gonna send b over okay and just actually maybe make the notation a bit easier to remember i'm going to actually have i'm going to kind of make a small change into my notation and instead of saying that mallory picked m i would imagine she picked m sub a lowercase m sub he said or uppercase m sub a she completed lowercase m sub a um and then computed uppercase m sub a from that and then sent uppercase m sub a to bob okay and then uh when she saw bob's message back to alice let's say she did the same thing she computed a lowercase m sub b from uh zero to p minus one and she computed uppercase m sub b okay from uh is g to the m sub b mod p and let's say she sent this m sub b to alice now what is alice going to compute well alice sees remember the way that alice works if she sees m sub b and she's going to compute she's not going to know that she's receiving mgb for all she knows she's getting a value b back from bob she has no idea that it's been modified by mallory and so alice will go ahead and she's going to compute simply compute um this value and you know she's going to take m to b raised to the 8th power she's going to compute m sub b to the a which in this case is basically equal and remember m sub b was g to the lowercase m sub b so g to the lowercase m sub b uh raised to the eighth power so we multiply the exponents g to the m to b times a mod p and that's her version of spirit secret okay and likewise what is bob's version going to be and again you can you can figure this out as well i'm going to pause and try to figure it out but if you want to see the spoiler well bob he computes basically he takes what he thinks of as a which he's really got an m sub a because mallory's interfered and he raises that to the b power okay and m sub a is basically g to the m sub a uh raised to the b power and so he's really getting you know g to the m sub a times b this is all done mod p so no no i won't write the mod p down i mean it's just because of convenience but you should always assume that it's there kind of implicitly and now let's think about what's happening here so alice has m sub b g to the m sub b times a and bob has g to the a m sub a times b now mallory can actually compute both of these things on her own why she can it turns out mallory can actually compute uh some things of her own so she knows m sub b and she knows m sub a she sees a from alice so let's look what happens when she computes um so let's think about what's going to happen here right so she's going to be able to take um the the m sub a that she gets or the value of the value of a that she gets from alice and what is that value a that's basically just g to the a that she got from alice and what if she raises that to the m sub b power she knows m to b because she came up with it right that's equal to g to the g to the a to the m's b or g to the m sub you can also write this as uh g to the m sub b times a mod p right so she actually mallory knows the same shared secret as alice she knows his value as well and similarly what you'll also notice is what else is malarina or she can also compute um she knows uh she gets b from bob and bob gamer g to the b mallory knows and lowercase m sub a because she picked it herself so she picks few the b times m sub a okay and so she knows this value mod p as well and uh let's start to notice that well she knows this value monkey which is the same thing is what bob computed so in fact what's really happened here is instead of alice and bob having a shared secret that nobody knows in reality alice has a secret with mallory and bob also has a secret mallory they might think alice and bob might think the secret that they know to each other but really mallory knows there's really two secrets here two truly secret values mallory knows them both neither bob nor alice knows that mallory knows him because mallory has interfered with the protocol so effectively what we've done here is is shown how somebody who can actively interfere with the protocol actually modifying the protocol messages and replacing them with their own can interfere with uh with diffie-hellman and so really dippy helmet or textbook diffie-hellman as people that you typically call it is only secure against passive eavesdroppers so in other words tiffy hellmann is secure against passive eavesdroppers these passive eavesdroppers people have been only listening to the conversation and not really um change anything but if somebody can change anything you do have somebody like a mallory who can actively interfere with the protocol then diffie helmets must be insecure versus an active adversary or an active uh people somebody being malicious is actually modifying messages so an active adversary um and i should make one clarification you know when you say tiffy helm is secure it doesn't mean that we actually have no proof it's unconditionally secure it's just that it's believed to be secure in fact there's always a possibility somebody will come up with an attack although it's unlikely at this stage but for the most part um you know when we talk about a cryptographic protocol being secure we almost always mean like something in basically one rare instance we almost always mean that the protocol is believed to be secure that the best known attack against it is still uh not quite one that's feasible and that's the case for tiffany helman the best known attacks on dp helmet are not quite feasible uh but that doesn't mean one such attack doesn't exist uh maybe that'll be a subject for a future video but i thought i think i'll stop here and hopefully you understand now why diffie-hellman requires or is only secure against a passive adversary and not necessarily secure against actually insecure rather against an active adversary thanks a lot and i will see you in the next video  
